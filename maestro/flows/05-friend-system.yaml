appId: com.guinote2
---
# Test: Friend System Flow
# Tests friend requests, acceptance, and playing together

- launchApp:
    clearState: true

# Wait for main screen
- assertVisible: 'Jugar'

# Navigate to Social tab
- tapOn: 'SOCIAL'

# Handle possible login requirement
- runFlow:
    when:
      visible: 'Iniciar SesiÃ³n'
    commands:
      - tapOn: 'Cancelar'
      - pressKey: back

# If logged in, continue with friend flow (new Social screen)
- runFlow:
    when:
      visible: 'AMIGOS'
    commands:
      # Switch to Buscar tab
      - tapOn: 'Buscar'

      # Enter search query and use search button
      - inputText: 'Carlos'
      - tapOn: 'ðŸ”Ž'

      # Switch to Solicitud tab
      - tapOn: 'Solicitud'

      # Check if we have incoming requests
      - runFlow:
          when:
            visible: 'Aceptar'
          commands:
            - tapOn: 'Aceptar'
            - assertVisible: 'AMIGOS'

      # Go back to friends list
      - tapOn: 'Todos los Amigos'

      # Check online friends
      - tapOn: 'En LÃ­nea'

      # Invite friend to play
      - runFlow:
          when:
            visible: 'Invitar a Jugar'
          commands:
            - tapOn: 'Invitar a Jugar'

            # Should navigate to room creation
            - assertVisible: 'Crear Sala'

            # Create room with friend
            - tapOn: 'Crear Sala'

            # Wait for friend to join
            - assertVisible: 'Esperando jugadores'

            # Add AI to complete the game
            - tapOn: 'AÃ±adir IA'
            - tapOn: 'AÃ±adir IA'

            # Ready up
            - tapOn: 'Listo'

      # Return to main menu
      - pressKey: back

# Handle blocked users section
- runFlow:
    when:
      visible: 'Usuarios Bloqueados'
    commands:
      # Check blocked users management
      - tapOn: 'Usuarios Bloqueados'

      # Unblock if any blocked users
      - runFlow:
          when:
            visible: 'Desbloquear'
          commands:
            - tapOn: 'Desbloquear'
            - assertVisible: 'Usuario desbloqueado'

      - pressKey: back

# Return to main menu
- pressKey: back
- assertVisible: 'Jugar'
